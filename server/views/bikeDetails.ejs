<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Bike Details</title>
    <link rel="stylesheet" href="/stylesheets/style.css" />
  </head>
  <body>
    <h1>Bike Details</h1>
    <table>
      <tr>
        <th colspan="2">Bike Details</th>
      </tr>
      <tr>
        <th>Bike Attribute</th>
        <th>Value</th>
      </tr>
      <% for (const key in bike) { %>
      <tr>
        <td><%= key %></td>
        <td><%= bike[key] %></td>
      </tr>
      <% } %>
    </table>
    <% if (bikes.length > 0) { %>
    <img src="<%= bikes[0].image_url %>" alt="Bike Image" />
    <% } %>
    <a href="/">Back to Search</a>
    <script>
      document.addEventListener("DOMContentLoaded", () => {
        const urlParams = new URLSearchParams(window.location.search);
        const bikeId = urlParams.get("id");

        fetch(`/api/bikefeatures/${bikeId}`)
          .then((response) => response.json())
          .then((bike) => {
            const bikeDetailsContainer = document.getElementById("bikeDetails");
            const table = document.createElement("table");
            const headerRow = document.createElement("tr");
            const bikeDetailsHeader = document.createElement("th");
            bikeDetailsHeader.setAttribute("colspan", "2");
            bikeDetailsHeader.textContent = "Bike Details";
            headerRow.appendChild(bikeDetailsHeader);
            table.appendChild(headerRow);

            const attributeRow = document.createElement("tr");
            const attributeHeader = document.createElement("th");
            attributeHeader.textContent = "Bike Attribute";
            const valueHeader = document.createElement("th");
            valueHeader.textContent = "Value";
            attributeRow.appendChild(attributeHeader);
            attributeRow.appendChild(valueHeader);
            table.appendChild(attributeRow);

            for (const key in bike) {
              if (Object.hasOwnProperty.call(bike, key)) {
                const row = document.createElement("tr");
                const attributeCell = document.createElement("td");
                const valueCell = document.createElement("td");
                attributeCell.textContent = key;
                valueCell.textContent = bike[key];
                row.appendChild(attributeCell);
                row.appendChild(valueCell);
                table.appendChild(row);
              }
            }
            bikeDetailsContainer.appendChild(table);
          })
          .catch((error) =>
            console.error("Error loading bike details:", error)
          );
      });
    </script>
  </body>
</html>
